app:
  description: æ™ºèƒ½è¯é¢˜å†…å®¹ç”Ÿæˆå™¨ï¼Œæ ¹æ®é¢„è®¾ç±»å‹ç”Ÿæˆè¯é¢˜å’Œå†…å®¹ï¼Œé›†æˆSQLiteæ•°æ®åº“å’Œå‘é‡å»é‡
  icon: '#'
  icon_background: '#FF6B6B'
  mode: workflow
  name: è¯é¢˜å†…å®¹ç”Ÿæˆå™¨
  use_icon_as_answer_icon: false
dependencies:
- current_identifier: null
  type: marketplace
  value:
    marketplace_plugin_unique_identifier: langgenius/volcengine_maas:0.0.30@0e6b13a721cc8fb7b928787f86ffc57655ace2cbc938c4738c209d70b18a85f8
workflow:
  conversation_variables: []
  environment_variables: []
  features:
    file_upload:
      allowed_file_extensions:
      - .JPG
      - .JPEG
      - .PNG
      - .GIF
      - .WEBP
      - .SVG
      allowed_file_types:
      - image
      allowed_file_upload_methods:
      - local_file
      - remote_url
      enabled: false
      fileUploadConfig:
        audio_file_size_limit: 50
        batch_count_limit: 5
        file_size_limit: 15
        image_file_size_limit: 10
        video_file_size_limit: 100
        workflow_file_upload_limit: 10
      image:
        enabled: false
        number_limits: 3
        transfer_methods:
        - local_file
        - remote_url
      number_limits: 3
    opening_statement: 'æ¬¢è¿ä½¿ç”¨æ™ºèƒ½è¯é¢˜å†…å®¹ç”Ÿæˆå™¨ï¼


      åŠŸèƒ½ç‰¹è‰²ï¼š

      - å¤šç±»å‹è¯é¢˜ç”Ÿæˆï¼ˆå¨±ä¹ã€å…«å¦ã€ç§‘æŠ€ç­‰ï¼‰

      - å¯æ§åˆ¶ç”Ÿæˆæ•°é‡

      - å‘é‡å»é‡é¿å…é‡å¤

      - è‡ªåŠ¨å­˜å‚¨åˆ°SQLiteæ•°æ®åº“

      - æ™ºèƒ½å…³é”®è¯æå–


      è¯·è®¾ç½®æ‚¨è¦ç”Ÿæˆçš„è¯é¢˜ç±»å‹å’Œæ•°é‡ï¼š

      '
    retriever_resource:
      enabled: true
    sensitive_word_avoidance:
      enabled: false
    speech_to_text:
      enabled: false
    suggested_questions:
    - ç”Ÿæˆ5æ¡å¨±ä¹ç±»è¯é¢˜
    - ç”Ÿæˆ3æ¡ç§‘æŠ€ç±»è¯é¢˜
    - ç”Ÿæˆ10æ¡ç”Ÿæ´»ç±»è¯é¢˜
    - ç”Ÿæˆ2æ¡ç¾é£Ÿç±»è¯é¢˜
    suggested_questions_after_answer:
      enabled: false
    text_to_speech:
      enabled: false
      language: ''
      voice: ''
  graph:
    edges:
    - data:
        isInIteration: false
        sourceType: start
        targetType: code
      id: 1736424593742-source-1736424595123-target
      source: '1736424593742'
      sourceHandle: source
      target: '1736424595123'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: code
        targetType: iteration
      id: 1736424595123-source-1736424800000-target
      source: '1736424595123'
      sourceHandle: source
      target: '1736424800000'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: true
        sourceType: llm
        targetType: llm
      id: 1736424598201-source-1736424599234-target
      source: '1736424598201'
      sourceHandle: source
      target: '1736424599234'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: true
        sourceType: llm
        targetType: code
      id: 1736424599234-source-1736424601456-target
      source: '1736424599234'
      sourceHandle: source
      target: '1736424601456'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: true
        sourceType: code
        targetType: tool
      id: 1736424601456-source-1757476920544-target
      source: '1736424601456'
      sourceHandle: source
      target: '1757476920544'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: true
        sourceType: tool
        targetType: code
      id: 1757476920544-source-1736424603678-target
      source: '1757476920544'
      sourceHandle: source
      target: '1736424603678'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: iteration
        targetType: code
      id: 1736424800000-source-1736424900000-target
      source: '1736424800000'
      sourceHandle: source
      target: '1736424900000'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: code
        targetType: end
      id: 1736424900000-source-1736424600123-target
      source: '1736424900000'
      sourceHandle: source
      target: '1736424600123'
      targetHandle: target
      type: custom
      zIndex: 0
    nodes:
    - data:
        desc: è¾“å…¥è¯é¢˜ç”Ÿæˆå‚æ•°
        selected: false
        title: å¼€å§‹
        type: start
        variables:
        - description: é€‰æ‹©è¦ç”Ÿæˆçš„è¯é¢˜ç±»å‹
          label: è¯é¢˜ç±»å‹
          options:
          - å¨±ä¹å…«å¦
          - ç§‘æŠ€æ•°ç 
          - ç”Ÿæ´»æ—¶å°š
          - ç¾é£Ÿæ—…æ¸¸
          - ä½“è‚²å¥èº«
          - æ•™è‚²å­¦ä¹ 
          - èŒåœºå•†ä¸š
          - æƒ…æ„Ÿå¿ƒç†
          - æ¸¸æˆåŠ¨æ¼«
          - è‰ºæœ¯æ–‡åŒ–
          required: true
          type: select
          variable: topic_type
        - description: æŒ‡å®šè¦ç”Ÿæˆçš„è¯é¢˜æ•°é‡ï¼ˆ1-10æ¡ï¼‰
          label: ç”Ÿæˆæ•°é‡
          max_length: 2
          options: []
          required: true
          type: text-input
          variable: generation_count
        - description: å¯é€‰çš„é¢å¤–è¦æ±‚æˆ–åå¥½è®¾ç½®
          label: é¢å¤–è¦æ±‚
          max_length: 500
          options: []
          required: false
          type: paragraph
          variable: additional_requirements
      height: 169
      id: '1736424593742'
      position:
        x: 80
        y: 282
      positionAbsolute:
        x: 80
        y: 282
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 243
    - data:
        code: "import json\nimport re\n\ndef main(topic_type: str, generation_count:\
          \ str, additional_requirements: str) -> dict:\n    \"\"\"\n    é¢„å¤„ç†è¾“å…¥å‚æ•°å’Œå‡†å¤‡æŸ¥è¯¢æ¡ä»¶\n\
          \    \"\"\"\n    \n    # éªŒè¯å’Œè½¬æ¢ç”Ÿæˆæ•°é‡\n    try:\n        count = int(generation_count.strip())\n\
          \        if count < 1 or count > 10:\n            count = 1\n    except\
          \ (ValueError, AttributeError):\n        count = 1\n    \n    # è¯é¢˜ç±»å‹æ˜ å°„å’Œæç¤ºè¯æ¨¡æ¿\n\
          \    topic_templates = {\n        \"å¨±ä¹å…«å¦\": {\n            \"keywords\"\
          : [\"æ˜æ˜Ÿ\", \"å¨±ä¹åœˆ\", \"å½±è§†\", \"ç»¼è‰º\", \"éŸ³ä¹\", \"æ—¶å°š\"],\n            \"description\"\
          : \"å¨±ä¹åœˆè¶£é—»ã€æ˜æ˜ŸåŠ¨æ€ã€å½±è§†ä½œå“è®¨è®º\",\n            \"style\": \"è½»æ¾æœ‰è¶£ï¼Œé€‚åˆèŠå¤©\"\n       \
          \ },\n        \"ç§‘æŠ€æ•°ç \": {\n            \"keywords\": [\"ç§‘æŠ€\", \"æ•°ç \", \"\
          AI\", \"æ‰‹æœº\", \"ç”µè„‘\", \"åˆ›æ–°\"],\n            \"description\": \"ç§‘æŠ€äº§å“ã€æ•°å­—ç”Ÿæ´»ã€æŠ€æœ¯è¶‹åŠ¿\"\
          ,\n            \"style\": \"ä¸“ä¸šä½†é€šä¿—æ˜“æ‡‚\"\n        },\n        \"ç”Ÿæ´»æ—¶å°š\": {\n\
          \            \"keywords\": [\"ç”Ÿæ´»\", \"æ—¶å°š\", \"ç©¿æ­\", \"ç¾å¦†\", \"å±…å®¶\", \"å“å‘³\"\
          ],\n            \"description\": \"ç”Ÿæ´»æ–¹å¼ã€æ—¶å°šæ­é…ã€ç¾å®¹æŠ¤è‚¤\",\n            \"style\"\
          : \"å®ç”¨ä¸”æœ‰è¶£å‘³æ€§\"\n        },\n        \"ç¾é£Ÿæ—…æ¸¸\": {\n            \"keywords\"\
          : [\"ç¾é£Ÿ\", \"æ—…æ¸¸\", \"é¤å…\", \"æ™¯ç‚¹\", \"æ–‡åŒ–\", \"ä½“éªŒ\"],\n            \"description\"\
          : \"ç¾é£Ÿæ¨èã€æ—…è¡Œä½“éªŒã€åœ°æ–¹æ–‡åŒ–\",\n            \"style\": \"è¯±äººä¸”å¯Œæœ‰ä½“éªŒæ„Ÿ\"\n        },\n\
          \        \"ä½“è‚²å¥èº«\": {\n            \"keywords\": [\"ä½“è‚²\", \"å¥èº«\", \"è¿åŠ¨\"\
          , \"é”»ç‚¼\", \"æ¯”èµ›\", \"å¥åº·\"],\n            \"description\": \"è¿åŠ¨å¥èº«ã€ä½“è‚²èµ›äº‹ã€å¥åº·ç”Ÿæ´»\"\
          ,\n            \"style\": \"ç§¯ææ­£èƒ½é‡\"\n        },\n        \"æ•™è‚²å­¦ä¹ \": {\n \
          \           \"keywords\": [\"æ•™è‚²\", \"å­¦ä¹ \", \"çŸ¥è¯†\", \"æŠ€èƒ½\", \"æˆé•¿\", \"å‘å±•\"\
          ],\n            \"description\": \"å­¦ä¹ æ–¹æ³•ã€æ•™è‚²è¯é¢˜ã€çŸ¥è¯†åˆ†äº«\",\n            \"style\"\
          : \"å¯å‘æ€§å’Œå®ç”¨æ€§\"\n        },\n        \"èŒåœºå•†ä¸š\": {\n            \"keywords\"\
          : [\"èŒåœº\", \"å•†ä¸š\", \"å·¥ä½œ\", \"ç®¡ç†\", \"åˆ›ä¸š\", \"å‘å±•\"],\n            \"description\"\
          : \"èŒåœºæŠ€èƒ½ã€å•†ä¸šæ€ç»´ã€å·¥ä½œç”Ÿæ´»\",\n            \"style\": \"ä¸“ä¸šä¸”æœ‰æŒ‡å¯¼æ„ä¹‰\"\n        },\n\
          \        \"æƒ…æ„Ÿå¿ƒç†\": {\n            \"keywords\": [\"æƒ…æ„Ÿ\", \"å¿ƒç†\", \"å…³ç³»\"\
          , \"æˆé•¿\", \"æ²»æ„ˆ\", \"æ„Ÿæ‚Ÿ\"],\n            \"description\": \"æƒ…æ„Ÿè¯é¢˜ã€å¿ƒç†å¥åº·ã€äººé™…å…³ç³»\"\
          ,\n            \"style\": \"æ¸©æš–æ²»æ„ˆï¼Œæœ‰å…±é¸£\"\n        },\n        \"æ¸¸æˆåŠ¨æ¼«\": {\n\
          \            \"keywords\": [\"æ¸¸æˆ\", \"åŠ¨æ¼«\", \"äºŒæ¬¡å…ƒ\", \"è§’è‰²\", \"å‰§æƒ…\", \"\
          ç¤¾åŒº\"],\n            \"description\": \"æ¸¸æˆä½“éªŒã€åŠ¨æ¼«ä½œå“ã€äºŒæ¬¡å…ƒæ–‡åŒ–\",\n            \"\
          style\": \"æœ‰è¶£ä¸”æœ‰è¯é¢˜æ€§\"\n        },\n        \"è‰ºæœ¯æ–‡åŒ–\": {\n            \"keywords\"\
          : [\"è‰ºæœ¯\", \"æ–‡åŒ–\", \"åˆ›ä½œ\", \"å®¡ç¾\", \"ä¼ ç»Ÿ\", \"ç°ä»£\"],\n            \"description\"\
          : \"è‰ºæœ¯ä½œå“ã€æ–‡åŒ–ç°è±¡ã€åˆ›ä½œåˆ†äº«\",\n            \"style\": \"æœ‰æ·±åº¦ä¸”æ˜“äºç†è§£\"\n        }\n\
          \    }\n    \n    # è·å–å½“å‰ç±»å‹çš„é…ç½®\n    current_config = topic_templates.get(topic_type,\
          \ topic_templates[\"å¨±ä¹å…«å¦\"])\n    \n    # æ„å»ºæŸ¥è¯¢å…³é”®è¯ç”¨äºå‘é‡æ£€ç´¢\n    search_keywords\
          \ = \" \".join(current_config[\"keywords\"][:3])  # ä½¿ç”¨å‰3ä¸ªå…³é”®è¯\n    \n   \
          \ # æ¸…ç†é¢å¤–è¦æ±‚\n    additional_req = additional_requirements.strip() if additional_requirements\
          \ else \"\"\n    \n    # ä¸ºå¾ªç¯ç”Ÿæˆå‡†å¤‡æ•°ç»„\n    loop_items = []\n    for i in range(count):\n        loop_items.append({\n            \"index\": i + 1,\n            \"topic_type\": topic_type,\n            \"search_keywords\": search_keywords,\n            \"query_text\": f\"{topic_type} {search_keywords}\"\n        })\n    \n    return {\n        \"processed_topic_type\": topic_type,\n\
          \        \"validated_count\": count,\n        \"search_keywords\": search_keywords,\n\
          \        \"topic_config\": current_config,\n        \"additional_requirements\"\
          : additional_req,\n        \"query_text\": f\"{topic_type} {search_keywords}\"\
          ,\n        \"generation_context\": f\"ç±»å‹ï¼š{topic_type}ï¼Œå…³é”®è¯ï¼š{search_keywords}ï¼Œè¦æ±‚ï¼š{additional_req}\",\n        \"loop_items\": loop_items\
          \n    }\n"
        code_language: python3
        desc: é¢„å¤„ç†è¾“å…¥å‚æ•°
        outputs:
          additional_requirements:
            description: é¢å¤–è¦æ±‚
            type: string
          generation_context:
            description: ç”Ÿæˆä¸Šä¸‹æ–‡
            type: string
          processed_topic_type:
            description: å¤„ç†åçš„è¯é¢˜ç±»å‹
            type: string
          query_text:
            description: æŸ¥è¯¢æ–‡æœ¬
            type: string
          search_keywords:
            description: æœç´¢å…³é”®è¯
            type: string
          topic_config:
            description: è¯é¢˜é…ç½®ä¿¡æ¯
            type: object
          validated_count:
            description: éªŒè¯åçš„ç”Ÿæˆæ•°é‡
            type: number
          loop_items:
            description: å¾ªç¯ç”Ÿæˆé¡¹ç›®æ•°ç»„
            type: array[object]
        selected: false
        title: å‚æ•°é¢„å¤„ç†
        type: code
        variables:
        - value_selector:
          - '1736424593742'
          - topic_type
          variable: topic_type
        - value_selector:
          - '1736424593742'
          - generation_count
          variable: generation_count
        - value_selector:
          - '1736424593742'
          - additional_requirements
          variable: additional_requirements
      height: 81
      id: '1736424595123'
      position:
        x: 384
        y: 282
      positionAbsolute:
        x: 384
        y: 282
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 243
    - data:
        context:
          enabled: false
          variable_selector: []
        desc: ç”Ÿæˆè¯é¢˜å’Œå†…å®¹
        model:
          completion_params:
            frequency_penalty: 0.3
            max_tokens: 800
            presence_penalty: 0.2
            temperature: 0.8
            top_p: 0.9
          mode: chat
          name: Doubao-Seed-1.6
          provider: langgenius/volcengine_maas/volcengine_maas
        prompt_template:
        - id: 3a89b9f5-3cc0-4f7d-9b28-f5b2bc8d91c3
          role: system
          text: "ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„è¯é¢˜å†…å®¹ç”Ÿæˆä¸“å®¶ï¼Œæ“…é•¿åˆ›ä½œå¸å¼•äººçš„èŠå¤©è¯é¢˜ã€‚\n\n**å½“å‰ç”Ÿæˆä»»åŠ¡ï¼š**\n- è¯é¢˜ç±»å‹ï¼š{{#1736424595123.processed_topic_type#}}\n\
            - è¯é¢˜é£æ ¼ï¼š{{#1736424595123.topic_config.style#}}\n- å†…å®¹ç‰¹å¾ï¼š{{#1736424595123.topic_config.description#}}\n\
            - å…³é”®è¯èŒƒå›´ï¼š{{#1736424595123.search_keywords#}}\n{% if 1736424595123.additional_requirements\
            \ %}\n- é¢å¤–è¦æ±‚ï¼š{{#1736424595123.additional_requirements#}}\n{% endif %}\n\
            \n**ç”Ÿæˆè¦æ±‚ï¼š**\n1. ç”Ÿæˆ1ä¸ªå…¨æ–°ä¸”æœ‰è¶£çš„è¯é¢˜\n\
            2. è¯é¢˜è¦æœ‰è¶£ã€æœ‰è®¨è®ºä»·å€¼ï¼Œé€‚åˆæ—¥å¸¸èŠå¤©\n3. å†…å®¹è¦å…·ä½“ç”ŸåŠ¨ï¼Œä¸è¦ç©ºæ³›çš„æè¿°\n4. é¿å…æ—¶æ•ˆæ€§è¯é¢˜ï¼ˆå¦‚å…·ä½“æ—¥æœŸã€å½“å‰äº‹ä»¶ç­‰ï¼‰\n5.\
            \ å†…å®¹é•¿åº¦100-300å­—ï¼Œè¯­è¨€è½»æ¾è‡ªç„¶\n6. ç¡®ä¿å†…å®¹ç§¯ææ­£é¢ï¼Œæ— æ•æ„Ÿä¿¡æ¯\n\n**è¾“å‡ºæ ¼å¼ï¼š**\nä¸¥æ ¼æŒ‰ç…§ä»¥ä¸‹JSONæ ¼å¼è¾“å‡ºï¼Œä¸è¦æ·»åŠ ä»»ä½•å…¶ä»–æ–‡å­—ï¼š\n\
            ```json\n{\n  \"topic_title\": \"è¯é¢˜æ ‡é¢˜ï¼ˆ10-30å­—ï¼‰\",\n  \"topic_content\"\
            : \"è¯¦ç»†å†…å®¹æè¿°ï¼ˆ100-300å­—ï¼‰\",\n  \"category\": \"{{#1736424595123.processed_topic_type#}}\"\
            \n}\n```\n"
        - id: 8b7c9f2e-1c45-4d8f-9e32-a5d6c7b8f9e0
          role: user
          text: 'è¯·æ ¹æ®ä¸Šè¿°è¦æ±‚ï¼Œä¸º"{{#1736424595123.processed_topic_type#}}"ç±»åˆ«ç”Ÿæˆä¸€ä¸ªå…¨æ–°çš„è¯é¢˜å’Œå†…å®¹ã€‚


            é‡ç‚¹å…³æ³¨ï¼š

            - å†…å®¹çš„åŸåˆ›æ€§å’Œç‹¬ç‰¹æ€§

            - å†…å®¹çš„è¶£å‘³æ€§å’Œè®¨è®ºä»·å€¼

            - é€‚åˆAIèŠå¤©åœºæ™¯ä½¿ç”¨

            '
        selected: false
        title: è¯é¢˜å†…å®¹ç”Ÿæˆ
        type: llm
        variables: []
        vision:
          enabled: false
      height: 117
      id: '1736424598201'
      position:
        x: 992
        y: 282
      positionAbsolute:
        x: 992
        y: 282
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 243
    - data:
        context:
          enabled: false
          variable_selector: []
        desc: ç”Ÿæˆæœç´¢å…³é”®è¯
        model:
          completion_params:
            frequency_penalty: 0.1
            max_tokens: 100
            presence_penalty: 0
            temperature: 0.3
            top_p: 0.9
          mode: chat
          name: Doubao-Seed-1.6
          provider: langgenius/volcengine_maas/volcengine_maas
        prompt_template:
        - id: 4b8d9f3e-2c46-5e9f-0f33-b6e7d8c9fa10
          role: system
          text: 'ä½ æ˜¯ä¸€ä¸ªå…³é”®è¯æå–ä¸“å®¶ï¼Œéœ€è¦ä¸ºè¯é¢˜å†…å®¹ç”Ÿæˆ3-5ä¸ªç²¾å‡†çš„æœç´¢å…³é”®è¯ã€‚


            **è¦æ±‚ï¼š**

            1. å…³é”®è¯è¦èƒ½å‡†ç¡®æ¦‚æ‹¬è¯é¢˜æ ¸å¿ƒ

            2. é€‚åˆæœç´¢å¼•æ“å’Œæ¨èç®—æ³•ä½¿ç”¨

            3. ä½¿ç”¨ç®€æ´çš„è¯è¯­ï¼Œé¿å…é•¿å¥

            4. åŒ…å«è¯é¢˜ç±»åˆ«çš„æ ¸å¿ƒè¯æ±‡

            5. å…³é”®è¯ä¹‹é—´ç”¨ç©ºæ ¼åˆ†éš”


            **è¾“å‡ºæ ¼å¼ï¼š**

            åªè¾“å‡ºå…³é”®è¯ï¼Œç”¨ç©ºæ ¼åˆ†éš”ï¼Œä¸è¦å…¶ä»–æ–‡å­—ã€‚

            ä¾‹å¦‚ï¼šå¨±ä¹ æ˜æ˜Ÿ å…«å¦ çƒ­ç‚¹ è¯é¢˜

            '
        - id: 9c8e0f4d-3d57-6f0g-1g44-c7f8e9d0gb21
          role: user
          text: 'è¯·ä¸ºä»¥ä¸‹è¯é¢˜ç”Ÿæˆæœç´¢å…³é”®è¯ï¼š


            è¯é¢˜ç±»å‹ï¼š{{#1736424595123.processed_topic_type#}}

            è¯é¢˜å†…å®¹ï¼š{{#1736424598201.text#}}

            '
        selected: false
        title: å…³é”®è¯ç”Ÿæˆ
        type: llm
        variables: []
        vision:
          enabled: false
      height: 117
      id: '1736424599234'
      position:
        x: 1296
        y: 282
      positionAbsolute:
        x: 1296
        y: 282
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 243
    - data:
        code: "import json\nimport re\nimport datetime\n\ndef main(topic_content:\
          \ str, search_keywords: str, processed_topic_type: str, validated_count:\
          \ int) -> dict:\n    \"\"\"\n    è§£æç”Ÿæˆçš„å†…å®¹ï¼Œå‡†å¤‡æ•°æ®åº“å­˜å‚¨æ ¼å¼\n    \"\"\"\n    \n \
          \   try:\n        # å°è¯•è§£æJSONæ ¼å¼çš„è¯é¢˜å†…å®¹\n        if topic_content.strip().startswith('```json'):\n\
          \            # æå–JSONéƒ¨åˆ†\n            json_match = re.search(r'```json\\\
          s*\\n(.*?)\\n```', topic_content, re.DOTALL)\n            if json_match:\n\
          \                topic_data = json.loads(json_match.group(1))\n        \
          \    else:\n                raise ValueError(\"JSONæ ¼å¼è§£æå¤±è´¥\")\n        elif\
          \ topic_content.strip().startswith('{'):\n            topic_data = json.loads(topic_content)\n\
          \        else:\n            # å¦‚æœä¸æ˜¯JSONæ ¼å¼ï¼Œå°è¯•æ™ºèƒ½è§£æ\n            topic_data\
          \ = {\n                \"topic_title\": \"ç”Ÿæˆçš„è¯é¢˜\",\n                \"topic_content\"\
          : topic_content,\n                \"category\": processed_topic_type\n \
          \           }\n        \n        # ç¡®ä¿å¿…è¦å­—æ®µå­˜åœ¨\n        title = topic_data.get(\"\
          topic_title\", \"æœªå‘½åè¯é¢˜\")\n        content = topic_data.get(\"topic_content\"\
          , topic_content)\n        category = topic_data.get(\"category\", processed_topic_type)\n\
          \        \n        # æ¸…ç†å’ŒéªŒè¯æ•°æ®\n        title = title.strip()[:100]  # é™åˆ¶æ ‡é¢˜é•¿åº¦\n\
          \        content = content.strip()[:1000]  # é™åˆ¶å†…å®¹é•¿åº¦\n        keywords =\
          \ search_keywords.strip()[:200]  # é™åˆ¶å…³é”®è¯é•¿åº¦\n        \n        # å‡†å¤‡æ•°æ®åº“æ’å…¥çš„æ•°æ®æ ¼å¼\n\
          \        db_data = {\n            \"type\": category,\n            \"topic\"\
          : title,\n            \"content\": content,\n            \"search_keywords\"\
          : keywords,\n            \"status\": \"generated\",\n            \"metadata\"\
          : json.dumps({\n                \"generation_time\": datetime.datetime.now().isoformat(),\n\
          \                \"workflow\": \"topic_generator\",\n                \"\
          version\": \"1.0\"\n            }, ensure_ascii=False)\n        }\n    \
          \    \n        return {\n            \"success\": \"true\",\n          \
          \  \"db_data\": json.dumps(db_data, ensure_ascii=False),\n            \"\
          parsed_title\": title,\n            \"parsed_content\": content,\n     \
          \       \"parsed_keywords\": keywords,\n            \"parsed_category\"\
          : category,\n            \"remaining_count\": max(0, validated_count - 1)\n\
          \        }\n        \n    except Exception as e:\n        return {\n   \
          \         \"success\": \"false\",\n            \"error\": str(e),\n    \
          \        \"db_data\": \"{}\",\n            \"parsed_title\": \"è§£æå¤±è´¥\",\n\
          \            \"parsed_content\": topic_content,\n            \"parsed_keywords\"\
          : \"\",\n            \"parsed_category\": processed_topic_type,\n      \
          \      \"remaining_count\": validated_count\n        }\n"
        code_language: python3
        desc: æ•°æ®è§£æå¤„ç†
        outputs:
          db_data:
            description: æ•°æ®åº“æ’å…¥æ•°æ®JSON
            type: string
          parsed_category:
            description: è§£æåçš„ç±»åˆ«
            type: string
          parsed_content:
            description: è§£æåçš„å†…å®¹
            type: string
          parsed_keywords:
            description: è§£æåçš„å…³é”®è¯
            type: string
          parsed_title:
            description: è§£æåçš„æ ‡é¢˜
            type: string
          remaining_count:
            description: å‰©ä½™ç”Ÿæˆæ•°é‡
            type: number
          success:
            description: è§£ææ˜¯å¦æˆåŠŸ
            type: string
        selected: false
        title: æ•°æ®è§£æ
        type: code
        variables:
        - value_selector:
          - '1736424598201'
          - text
          variable: topic_content
        - value_selector:
          - '1736424599234'
          - text
          variable: search_keywords
        - value_selector:
          - '1736424595123'
          - processed_topic_type
          variable: processed_topic_type
        - value_selector:
          - '1736424595123'
          - validated_count
          variable: validated_count
      height: 81
      id: '1736424601456'
      position:
        x: 1611.428911041789
        y: 282
      positionAbsolute:
        x: 1611.428911041789
        y: 282
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 243
    - data:
        code: "import json\n\ndef main(sqlite_result: str, parsed_title: str, parsed_content:\
          \ str, parsed_keywords: str, parsed_category: str, remaining_count: int,\
          \ success: bool) -> dict:\n    \"\"\"\n    å¤„ç†SQLite APIå·¥å…·è¿”å›ç»“æœå¹¶æ ¼å¼åŒ–æœ€ç»ˆè¾“å‡º\n\
          \    \"\"\"\n    \n    try:\n        # è§£æSQLite APIå·¥å…·è¿”å›çš„ç»“æœ\n        # å¤„ç†ä¸åŒçš„æ•°æ®æ ¼å¼\n\
          \        if isinstance(sqlite_result, str):\n            db_result = json.loads(sqlite_result)\n\
          \        elif isinstance(sqlite_result, dict):\n            # æ£€æŸ¥æ˜¯å¦æ˜¯åŒ…è£…åœ¨jsonæ•°ç»„ä¸­çš„æ ¼å¼\n            if 'json' in sqlite_result and isinstance(sqlite_result['json'], list) and sqlite_result['json']:\n                db_result = sqlite_result['json'][0]  # å–ç¬¬ä¸€ä¸ªå…ƒç´ \n            else:\n                db_result = sqlite_result\n\
          \        else:\n            db_result = sqlite_result\n        \n      \
          \  if db_result.get(\"success\", False):\n            record_id = db_result.get(\"\
          record_id\", \"unknown\")\n            \n            formatted_output =\
          \ f\"\"\"\n**è¯é¢˜ç”ŸæˆæˆåŠŸï¼**\n\n**ç±»å‹ï¼š** {parsed_category}\n**æ ‡é¢˜ï¼š** {parsed_title}\n\
          **å†…å®¹ï¼š** {parsed_content}\n**å…³é”®è¯ï¼š** {parsed_keywords}\n**è®°å½•IDï¼š** {record_id}\n\
          **ç”Ÿæˆæ—¶é—´ï¼š** åˆšåˆš\n\n**å­˜å‚¨çŠ¶æ€ï¼š** æˆåŠŸä¿å­˜åˆ°SQLiteæ•°æ®åº“\n\n---\n**æç¤ºï¼š** æ­¤è¯é¢˜å·²ä¿å­˜åˆ°æ•°æ®åº“ï¼Œå¹¶å°†ç”¨äºå‘é‡å»é‡é¿å…é‡å¤ç”Ÿæˆã€‚\n\
          \n**å‰©ä½™å¾…ç”Ÿæˆï¼š** {remaining_count} æ¡\n            \"\"\"\n            \n   \
          \         return {\n                \"final_success\": \"true\",\n     \
          \           \"database_record_id\": record_id,\n                \"formatted_result\"\
          : formatted_output,\n                \"topic_data\": {\n               \
          \     \"type\": parsed_category,\n                    \"title\": parsed_title,\n\
          \                    \"content\": parsed_content,\n                    \"\
          keywords\": parsed_keywords,\n                    \"record_id\": record_id\n\
          \                }\n            }\n        else:\n            error_msg\
          \ = db_result.get(\"error\", \"æœªçŸ¥æ•°æ®åº“é”™è¯¯\")\n            details = db_result.get(\"\
          details\", \"\")\n            \n            formatted_output = f\"\"\"\n\
          **æ•°æ®å­˜å‚¨å¤±è´¥ï¼**\n\n**ç±»å‹ï¼š** {parsed_category}\n**æ ‡é¢˜ï¼š** {parsed_title}\n**å†…å®¹ï¼š**\
          \ {parsed_content}\n**å…³é”®è¯ï¼š** {parsed_keywords}\n\n**é”™è¯¯ä¿¡æ¯ï¼š** {error_msg}\n\
          **è¯¦ç»†ä¿¡æ¯ï¼š** {details}\n\n---\n**å»ºè®®ï¼š** è¯·æ£€æŸ¥SQLite APIæœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œï¼Œæˆ–é‡æ–°å°è¯•ç”Ÿæˆã€‚\n   \
          \         \"\"\"\n            \n            return {\n                \"\
          final_success\": \"false\",\n                \"database_record_id\": \"none\"\
          ,\n                \"formatted_result\": formatted_output,\n           \
          \     \"topic_data\": {\n                    \"type\": parsed_category,\n\
          \                    \"title\": parsed_title,\n                    \"content\"\
          : parsed_content,\n                    \"keywords\": parsed_keywords,\n\
          \                    \"record_id\": \"none\",\n                    \"error\"\
          : error_msg\n                },\n                \"error\": error_msg\n\
          \            }\n            \n    except Exception\
          \ as e:\n        formatted_output = f\"\"\"\n**ç»“æœå¤„ç†å¼‚å¸¸ï¼**\n\n**æ ‡é¢˜ï¼š** {parsed_title}\n\
          **å†…å®¹ï¼š** {parsed_content}\n\n**å¤„ç†é”™è¯¯ï¼š** {str(e)}\n\nåŸå§‹SQLiteç»“æœï¼š{str(sqlite_result)}\n\
          \n---\n**è°ƒè¯•ä¿¡æ¯ï¼š** è¯·æ£€æŸ¥APIå·¥å…·é…ç½®å’Œç½‘ç»œè¿æ¥ã€‚\n        \"\"\"\n        \n        return\
          \ {\n            \"final_success\": \"false\",\n            \"database_record_id\"\
          : \"none\",\n            \"formatted_result\": formatted_output,\n      \
          \      \"topic_data\": {\n                \"type\": parsed_category,\n  \
          \              \"title\": parsed_title,\n                \"content\": parsed_content,\n\
          \                \"keywords\": parsed_keywords,\n                \"record_id\"\
          : \"none\",\n                \"error\": str(e)\n            },\n        \
          \    \"error\": str(e)\n        }\n"
        code_language: python3
        desc: å¤„ç†æ•°æ®åº“ç»“æœ
        outputs:
          database_record_id:
            description: æ•°æ®åº“è®°å½•ID
            type: string
          final_success:
            description: æœ€ç»ˆæ“ä½œæ˜¯å¦æˆåŠŸ
            type: string
          formatted_result:
            description: æ ¼å¼åŒ–çš„æœ€ç»ˆç»“æœ
            type: string
          topic_data:
            description: è¯é¢˜æ•°æ®å¯¹è±¡
            type: object
          error:
            description: é”™è¯¯ä¿¡æ¯
            type: string
        selected: false
        title: ç»“æœå¤„ç†
        type: code
        variables:
        - value_selector:
          - '1757476920544'
          - text
          variable: sqlite_result
        - value_selector:
          - '1736424601456'
          - parsed_title
          variable: parsed_title
        - value_selector:
          - '1736424601456'
          - parsed_content
          variable: parsed_content
        - value_selector:
          - '1736424601456'
          - parsed_keywords
          variable: parsed_keywords
        - value_selector:
          - '1736424601456'
          - parsed_category
          variable: parsed_category
        - value_selector:
          - '1736424601456'
          - remaining_count
          variable: remaining_count
        - value_selector:
          - '1736424601456'
          - success
          variable: success
      height: 81
      id: '1736424603678'
      position:
        x: 2208
        y: 282
      positionAbsolute:
        x: 2208
        y: 282
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 243
    - data:
        desc: è¾“å‡ºæœ€ç»ˆç”Ÿæˆç»“æœ
        outputs:
        - value_selector:
          - '1736424900000'
          - formatted_result
          variable: result
        - value_selector:
          - '1736424900000'
          - final_success
          variable: success
        - value_selector:
          - '1736424900000'
          - total_generated
          variable: total_count
        - value_selector:
          - '1736424900000'
          - success_count
          variable: success_count
        - value_selector:
          - '1736424900000'
          - failed_count
          variable: failed_count
        selected: false
        title: ç»“æœè¾“å‡º
        type: end
      height: 196
      id: '1736424600123'
      position:
        x: 2512
        y: 282
      positionAbsolute:
        x: 2512
        y: 282
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 243
    - data:
        desc: ''
        is_team_authorization: true
        output_schema: null
        paramSchemas:
        - auto_generate: null
          default: null
          form: llm
          human_description:
            en_US: Name of the SQLite table to insert data into
            ja_JP: Name of the SQLite table to insert data into
            pt_BR: Name of the SQLite table to insert data into
            zh_Hans: Name of the SQLite table to insert data into
          label:
            en_US: table
            ja_JP: table
            pt_BR: table
            zh_Hans: table
          llm_description: Name of the SQLite table to insert data into
          max: null
          min: null
          name: table
          options: []
          placeholder:
            en_US: Name of the SQLite table to insert data into
            ja_JP: Name of the SQLite table to insert data into
            pt_BR: Name of the SQLite table to insert data into
            zh_Hans: Name of the SQLite table to insert data into
          precision: null
          required: true
          scope: null
          template: null
          type: string
        - auto_generate: null
          default: null
          form: llm
          human_description:
            en_US: JSON string containing the data to insert
            ja_JP: JSON string containing the data to insert
            pt_BR: JSON string containing the data to insert
            zh_Hans: JSON string containing the data to insert
          label:
            en_US: data
            ja_JP: data
            pt_BR: data
            zh_Hans: data
          llm_description: JSON string containing the data to insert
          max: null
          min: null
          name: data
          options: []
          placeholder:
            en_US: JSON string containing the data to insert
            ja_JP: JSON string containing the data to insert
            pt_BR: JSON string containing the data to insert
            zh_Hans: JSON string containing the data to insert
          precision: null
          required: true
          scope: null
          template: null
          type: string
        params:
          data: ''
          table: ''
        provider_id: 9222afa0-590b-4f4d-844f-7cf11f00489f
        provider_name: SQL-lite
        provider_type: api
        selected: true
        title: insert_data
        tool_configurations: {}
        tool_description: Insert a record into the specified SQLite table
        tool_label: insert_data
        tool_name: insert_data
        tool_node_version: '2'
        tool_parameters:
          data:
            type: mixed
            value: '{{#1736424601456.db_data#}}'
          table:
            type: mixed
            value: 'topics'
        type: tool
      height: 53
      id: '1757476920544'
      position:
        x: 1904
        y: 282
      positionAbsolute:
        x: 1904
        y: 282
      selected: true
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 243
    - data:
        desc: å¾ªç¯ç”Ÿæˆå¤šä¸ªè¯é¢˜
        iterator_selector:
        - '1736424595123'
        - loop_items
        output_selector:
        - '1736424603678'
        - topic_data
        output_type: array[object]
        selected: false
        title: å¾ªç¯ç”Ÿæˆ
        type: iteration
        start_node_id: '1736424598201'
        iteration_id: '1736424800000'
      height: 54
      id: '1736424800000'
      position:
        x: 688
        y: 282
      positionAbsolute:
        x: 688
        y: 282
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 243
    - data:
        code: "import json\n\ndef main(iteration_results: list) -> dict:\n    \"\"\"\n    æ±‡æ€»æ‰€æœ‰å¾ªç¯ç”Ÿæˆçš„ç»“æœ\n    \"\"\"\n    \n    try:\n        if not iteration_results:\n            return {\n                \"final_success\": \"false\",\n                \"formatted_result\": \"æœªç”Ÿæˆä»»ä½•è¯é¢˜\",\n                \"total_generated\": 0\n            }\n        \n        successful_topics = []\n        failed_topics = []\n        \n        for i, result in enumerate(iteration_results):\n            if isinstance(result, dict) and result.get('json') and isinstance(result['json'], list) and result['json']:\n                db_result = result['json'][0]\n                if db_result.get('success'):\n                    successful_topics.append({\n                        \"index\": i + 1,\n                        \"record_id\": db_result.get('record_id', 'unknown')\n                    })\n                else:\n                    failed_topics.append({\n                        \"index\": i + 1,\n                        \"error\": db_result.get('error', 'æœªçŸ¥é”™è¯¯')\n                    })\n        \n        total_count = len(iteration_results)\n        success_count = len(successful_topics)\n        \n        formatted_output = f\"\"\"ğŸ‰ è¯é¢˜ç”Ÿæˆæ‰¹é‡å®Œæˆï¼\n\n**ç”Ÿæˆç»Ÿè®¡ï¼š**\n- æ€»è®¡ç”Ÿæˆï¼š{total_count} ä¸ªè¯é¢˜\n- æˆåŠŸå­˜å‚¨ï¼š{success_count} ä¸ª\n- å¤±è´¥æ•°é‡ï¼š{len(failed_topics)} ä¸ª\n\n**æˆåŠŸçš„è¯é¢˜ï¼š**\n\"\"\"\n        \n        for topic in successful_topics:\n            formatted_output += f\"- ç¬¬{topic['index']}ä¸ªè¯é¢˜ (è®°å½•ID: {topic['record_id']})\\n\"\n        \n        if failed_topics:\n            formatted_output += \"\\n**å¤±è´¥çš„è¯é¢˜ï¼š**\\n\"\n            for topic in failed_topics:\n                formatted_output += f\"- ç¬¬{topic['index']}ä¸ªè¯é¢˜: {topic['error']}\\n\"\n        \n        formatted_output += \"\\nâœ… æ‰€æœ‰æˆåŠŸçš„è¯é¢˜å·²ä¿å­˜åˆ°SQLiteæ•°æ®åº“\"\n        \n        return {\n            \"final_success\": \"true\" if success_count > 0 else \"false\",\n            \"formatted_result\": formatted_output,\n            \"total_generated\": success_count,\n            \"success_count\": success_count,\n            \"failed_count\": len(failed_topics)\n        }\n        \n    except Exception as e:\n        return {\n            \"final_success\": \"false\",\n            \"formatted_result\": f\"ç»“æœæ±‡æ€»å¤±è´¥: {str(e)}\",\n            \"total_generated\": 0,\n            \"error\": str(e)\n        }\n"
        code_language: python3
        desc: æ±‡æ€»å¾ªç¯ç”Ÿæˆç»“æœ
        outputs:
          final_success:
            description: æœ€ç»ˆæ“ä½œæ˜¯å¦æˆåŠŸ
            type: string
          formatted_result:
            description: æ ¼å¼åŒ–çš„æœ€ç»ˆç»“æœ
            type: string
          total_generated:
            description: æˆåŠŸç”Ÿæˆçš„æ•°é‡
            type: number
          success_count:
            description: æˆåŠŸæ•°é‡
            type: number
          failed_count:
            description: å¤±è´¥æ•°é‡
            type: number
          error:
            description: é”™è¯¯ä¿¡æ¯
            type: string
        selected: false
        title: ç»“æœæ±‡æ€»
        type: code
        variables:
        - value_selector:
          - '1736424800000'
          - output
          variable: iteration_results
      height: 81
      id: '1736424900000'
      position:
        x: 2512
        y: 282
      positionAbsolute:
        x: 2512
        y: 282
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 243
    viewport:
      x: -1725.5301452556723
      y: 133.47717847077206
      zoom: 1.145517897979758
